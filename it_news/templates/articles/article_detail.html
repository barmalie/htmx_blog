{% extends "base.html" %}
{% block title %}{{ article.title }}{% endblock %}

{% block content %}
<article>
    <h1>{{ article.title }}</h1>
    <p>{{ article.content|linebreaks }}</p>
</article>

<section id="comments-section">
    <h2>Комментарии</h2>
    <div id="comment-list">
        {% include "includes/comments_list.html" with comments=comments %}
    </div>

    {% if user.is_authenticated %}
        <form hx-post="{% url 'add-comment' article.id %}"
              hx-target="#comment-list"
              hx-swap="beforeend"
              hx-on::after-request="this.reset()">
            {% csrf_token %}
            <textarea name="text" required></textarea>
            <button type="submit">Отправить</button>
        </form>
    {% else %}
        <p><a href="{% url 'login' %}">Войдите</a>, чтобы комментировать.</p>
    {% endif %}
</section>
{% endblock %}